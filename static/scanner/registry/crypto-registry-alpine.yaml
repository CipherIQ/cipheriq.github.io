# =====================================================================
#  Alpine Linux Crypto Registry
#  NOTE:
#    - Alpine uses musl C library (not glibc)
#    - Package manager: apk (Alpine Package Keeper)
#    - Focus: Containers, minimal footprint, security-hardened
#    - Default TLS: OpenSSL (LibreSSL was historical default)
# =====================================================================

version: 1

crypto_libraries:

  # ------------------------------------------------------------
  # OpenSSL (current default)
  # ------------------------------------------------------------
  - id: openssl
    pkg_patterns:
      - openssl
      - libcrypto3
      - libssl3
      - openssl-dev
    soname_patterns:
      - libcrypto.so.3
      - libssl.so.3
      - libcrypto.so
      - libssl.so
    algorithms:
      - RSA
      - ECDSA
      - AES
      - ChaCha20-Poly1305
      - SHA-256
      - SHA-384
      - SHA-512
      - X25519
      - P-256
      - P-384

  # ------------------------------------------------------------
  # LibreSSL (historical Alpine default, still available)
  # NOTE: Uses libtls.so as unique identifier to avoid
  #       conflicts with OpenSSL's libcrypto.so
  # ------------------------------------------------------------
  - id: libressl
    pkg_patterns:
      - libressl
      - libressl-dev
      - libretls
    soname_patterns:
      - libtls.so
    algorithms:
      - TLS-1.3
      - TLS-1.2
      - AES-GCM
      - ChaCha20-Poly1305
      - RSA
      - ECDSA

  # ------------------------------------------------------------
  # libsodium (modern crypto)
  # ------------------------------------------------------------
  - id: libsodium
    pkg_patterns:
      - libsodium
      - libsodium-dev
    soname_patterns:
      - libsodium.so
    algorithms:
      - X25519
      - Ed25519
      - ChaCha20-Poly1305
      - BLAKE2b
      - Argon2

  # ------------------------------------------------------------
  # GnuTLS
  # ------------------------------------------------------------
  - id: gnutls
    pkg_patterns:
      - gnutls
      - gnutls-dev
    soname_patterns:
      - libgnutls.so
      - libgnutls.so.30
    algorithms:
      - TLS-1.2
      - TLS-1.3
      - AES-GCM
      - ChaCha20-Poly1305
      - ECDSA
      - RSA

  # ------------------------------------------------------------
  # Nettle / Hogweed (GnuTLS crypto backend)
  # ------------------------------------------------------------
  - id: nettle
    pkg_patterns:
      - nettle
      - nettle-dev
    soname_patterns:
      - libnettle.so
      - libhogweed.so
    algorithms:
      - RSA
      - ECDSA
      - AES
      - ChaCha20
      - SHA-256

  # ------------------------------------------------------------
  # libgcrypt (GnuPG crypto core)
  # ------------------------------------------------------------
  - id: libgcrypt
    pkg_patterns:
      - libgcrypt
      - libgcrypt-dev
    soname_patterns:
      - libgcrypt.so
    algorithms:
      - RSA
      - DSA
      - ECDSA
      - AES
      - Twofish
      - SHA-256

  # ------------------------------------------------------------
  # mbedTLS
  # ------------------------------------------------------------
  - id: mbedtls
    pkg_patterns:
      - mbedtls
      - mbedtls-dev
    soname_patterns:
      - libmbedtls.so
      - libmbedcrypto.so
    algorithms:
      - TLS-1.2
      - AES-GCM
      - SHA-256
      - RSA
      - ECDSA

  # ------------------------------------------------------------
  # NSS (Network Security Services)
  # ------------------------------------------------------------
  - id: nss
    pkg_patterns:
      - nss
      - nss-dev
    soname_patterns:
      - libnss3.so
      - libnssutil3.so
      - libsmime3.so
    algorithms:
      - RSA
      - ECDSA
      - AES-GCM
      - ChaCha20-Poly1305


# =====================================================================
# Embedded Crypto Providers (Alpine-specific services)
# =====================================================================

embedded_crypto_apps:

  # ------------------------------------------------------------
  # OpenSSH (primary SSH implementation)
  # ------------------------------------------------------------
  - provider_id: openssh_internal
    binary_names:
      - ssh
      - sshd
      - ssh-keygen
    package_names:
      - openssh
      - openssh-server
      - openssh-client
    algorithms:
      - chacha20-poly1305@openssh.com
      - aes128-ctr
      - aes256-ctr
      - aes128-gcm@openssh.com
      - aes256-gcm@openssh.com
      - curve25519-sha256
      - ssh-ed25519
      - ssh-rsa
      - ecdsa-sha2-nistp256

  # ------------------------------------------------------------
  # BusyBox (minimal crypto in wget/ssl applets)
  # ------------------------------------------------------------
  - provider_id: busybox_internal
    binary_names:
      - busybox
    package_names:
      - busybox
      - busybox-ssl
    algorithms:
      - TLS-1.2
      - AES-GCM

  # ------------------------------------------------------------
  # nginx (web server with TLS)
  # ------------------------------------------------------------
  - provider_id: nginx_internal
    binary_names:
      - nginx
    package_names:
      - nginx
      - nginx-mod-http-ssl
    algorithms:
      - TLS-1.2
      - TLS-1.3
      - AES-GCM
      - ChaCha20-Poly1305

  # ------------------------------------------------------------
  # haproxy (load balancer with TLS)
  # ------------------------------------------------------------
  - provider_id: haproxy_internal
    binary_names:
      - haproxy
    package_names:
      - haproxy
      - haproxy-openrc
    algorithms:
      - TLS-1.2
      - TLS-1.3
      - AES-GCM
      - ChaCha20-Poly1305

  # ------------------------------------------------------------
  # stunnel (TLS wrapper)
  # ------------------------------------------------------------
  - provider_id: stunnel_internal
    binary_names:
      - stunnel
    package_names:
      - stunnel
    algorithms:
      - TLS-1.2
      - TLS-1.3
      - AES-GCM
      - RSA

  # ------------------------------------------------------------
  # Docker (container runtime with TLS registry access)
  # ------------------------------------------------------------
  - provider_id: docker_internal
    binary_names:
      - dockerd
      - docker
      - containerd
    package_names:
      - docker
      - docker-engine
      - containerd
    algorithms:
      - TLS-1.2
      - TLS-1.3
      - AES-GCM
      - SHA-256

  # ------------------------------------------------------------
  # WireGuard (modern VPN)
  # ------------------------------------------------------------
  - provider_id: wireguard_internal
    binary_names:
      - wg
      - wg-quick
    package_names:
      - wireguard-tools
    algorithms:
      - ChaCha20
      - Poly1305
      - BLAKE2s
      - Curve25519
      - X25519
